{"version":3,"file":"QuadMatcherResourceType.js","sourceRoot":"","sources":["QuadMatcherResourceType.ts"],"names":[],"mappings":";;;AAIA;;;;;;;GAOG;AACH,MAAa,uBAAuB;IAMlC;;;;OAIG;IACH,YAAmB,SAAiB,EAAE,iBAA0B;QAC9D,IAAI,CAAC,IAAI,GAAG,IAAI,MAAM,CAAC,SAAS,EAAE,GAAG,CAAC,CAAC;QACvC,IAAI,CAAC,iBAAiB,GAAG,iBAAiB,CAAC;QAE3C,IAAI,CAAC,gBAAgB,GAAG,EAAE,CAAC;IAC7B,CAAC;IAEM,OAAO,CAAC,IAAc;QAC3B,+CAA+C;QAC/C,IAAI,IAAI,CAAC,OAAO,CAAC,QAAQ,KAAK,WAAW;YACvC,IAAI,CAAC,SAAS,CAAC,KAAK,KAAK,iDAAiD;YAC1E,IAAI,CAAC,MAAM,CAAC,QAAQ,KAAK,WAAW,IAAI,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,MAAM,CAAC,KAAK,CAAC,EAAE;YAC3E,IAAI,IAAI,CAAC,iBAAiB,EAAE;gBAC1B,IAAI,CAAC,gBAAgB,CAAC,IAAI,CAAC,OAAO,CAAC,KAAK,CAAC,GAAG,IAAI,CAAC;aAClD;YACD,OAAO,IAAI,CAAC;SACb;QAED,OAAO,IAAI,CAAC,iBAAiB;YAC3B,IAAI,CAAC,OAAO,CAAC,QAAQ,KAAK,WAAW,IAAI,IAAI,CAAC,OAAO,CAAC,KAAK,IAAI,IAAI,CAAC,gBAAgB,CAAC;IACzF,CAAC;CACF;AAhCD,0DAgCC","sourcesContent":["import type * as RDF from '@rdfjs/types';\n\nimport type { IQuadMatcher } from './IQuadMatcher';\n\n/**\n * A quad matcher that matches all resources of the given type.\n *\n * Blank nodes are not supported.\n *\n * WARNING: This matcher assumes that all the applicable resources\n * have `rdf:type` occurring as first triple with the resource IRI as subject.\n */\nexport class QuadMatcherResourceType implements IQuadMatcher {\n  private readonly type: RegExp;\n  private readonly matchFullResource: boolean;\n\n  public readonly matchingSubjects: Record<string, boolean>;\n\n  /**\n   * @param typeRegex Regular expression for type IRIs that need to be matched.\n   * @param matchFullResource If not only the quad containing the type must be matched,\n   *                          but also all other quads sharing the same subject of that quad.\n   */\n  public constructor(typeRegex: string, matchFullResource: boolean) {\n    this.type = new RegExp(typeRegex, 'u');\n    this.matchFullResource = matchFullResource;\n\n    this.matchingSubjects = {};\n  }\n\n  public matches(quad: RDF.Quad): boolean {\n    // Add buffer entry on applicable resource type\n    if (quad.subject.termType === 'NamedNode' &&\n      quad.predicate.value === 'http://www.w3.org/1999/02/22-rdf-syntax-ns#type' &&\n      quad.object.termType === 'NamedNode' && this.type.exec(quad.object.value)) {\n      if (this.matchFullResource) {\n        this.matchingSubjects[quad.subject.value] = true;\n      }\n      return true;\n    }\n\n    return this.matchFullResource &&\n      quad.subject.termType === 'NamedNode' && quad.subject.value in this.matchingSubjects;\n  }\n}\n"]}